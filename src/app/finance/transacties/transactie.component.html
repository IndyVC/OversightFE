<div class="container">

  <div style="display: block" class="graph" *ngIf='!piechartActive && smallScreen() || !smallScreen()' (swipe)=swipe()>
    <canvas baseChart [datasets]="barChartData" [labels]="barChartLabels" [options]="barChartOptions"
      [legend]="barChartLegend" [chartType]="chartType">
    </canvas>
  </div>

  <div style="display: block" class="graph" id="PIE" *ngIf='piechartActive && smallScreen() || !smallScreen()'
    (swipe)=swipe()>
    <canvas baseChart [datasets]="barChartDataP" [labels]="barChartLabelsP" [options]="barChartOptionsP"
      [legend]="barChartLegendP" [chartType]="chartTypeP">
    </canvas>
  </div>


  <div class="container_white">
    <div class="tabs">
      <button #tab1 id="selected" class="tab" (click)='switch(tab1,tab2);getIncomes()'>Inkomen</button>
      <button #tab2 class="tab" (click)='switch(tab2,tab1);getOutcomes()'>Uitgave</button>
    </div>

    <div class="metadata">
      <p>Oversight</p>
      <p> € {{getUser().calculateOversight()}}</p>
      <button class="addTransaction" (click)='openDialog()'>Voeg transactie toe</button>
      <div class="error" *ngIf="error!==''">
        <p>{{error}}</p>
      </div>
    </div>

    <cdk-virtual-scroll-viewport class="transactions" itemSize="20" style="height: 20vh">
      <ng-container *cdkVirtualFor='let transaction of getTransactions(); index as i'>
        <div class="transaction" [ngStyle]="{'background-color':i % 2 == 0?'#f6f5f6':'white'}">
          <mat-icon [ngStyle]="{'color': transaction.category.color, 'background-color':i % 2 == 0?'white':'#f6f5f6'}"
            class="icon">{{transaction.category.icon}}
          </mat-icon>
          <p class="name">{{transaction.name}}</p>
          <p class="amount">€ {{transaction.amount}}</p>
          <p class="date">
            {{transaction.date.toLocaleDateString()}}
          </p>
          <mat-icon class="clear" [ngStyle]="{'background-color':i % 2 == 0?'white':'#f6f5f6'}">clear</mat-icon>
        </div>
      </ng-container>
    </cdk-virtual-scroll-viewport>

    <div class="options">

      <div class="datepicker">
        <div class="incomeDate" *ngIf=incomeActive>
          <mat-form-field>
            <input matInput [matDatepicker]="picker1" placeholder="Vanaf wanneer"
              (dateChange)='updateIncomeDate($event)' (dateInput)='updateIncomeDate($event)'>
            <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
            <mat-datepicker #picker1></mat-datepicker>
          </mat-form-field>
        </div>

        <div class="outcomeDate" *ngIf=!incomeActive>
          <mat-form-field>
            <input matInput [matDatepicker]="picker2" placeholder="Vanaf wanneer"
              (dateChange)='updateOutcomeDate($event)' (dateInput)='updateOutcomeDate($event)'>
            <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
            <mat-datepicker #picker2></mat-datepicker>
          </mat-form-field>
        </div>
      </div>

      <div class="incomeCategory" *ngIf=incomeActive>
        <mat-form-field>
          <mat-label>Categorie</mat-label>
          <mat-select (selectionChange)='updateIncomeCategory($event)' multiple>
            <mat-option *ngFor='let category of getUser().getIncomeCategories()' [value]='category.name'>
              {{category.name}}
            </mat-option>
            <mat-option value="all">
              Allemaal
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="outcomeCategory" *ngIf=!incomeActive>
        <mat-form-field>
          <mat-label>Categorie</mat-label>
          <mat-select (selectionChange)='updateOutcomeCategory($event)' multiple>
            <mat-option *ngFor='let category of getUser().getOutcomeCategories()' [value]='category.name'>
              {{category.name}}
            </mat-option>
            <mat-option value="all">
              Allemaal
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

    </div>
  </div>
</div>
